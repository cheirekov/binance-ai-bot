# Spot profile (recommended starting defaults)
# Copy to `.env` (or merge into your existing `.env`) and edit. Never commit real secrets.
NODE_ENV=production
PORT=8788
FRONTEND_ORIGIN=http://localhost:4173

# Binance API credentials (SPOT only; use restricted keys + IP allow-list)
BINANCE_API_KEY=your_key
BINANCE_API_SECRET=your_secret
BINANCE_BASE_URL=https://api.binance.com

# Trading venue
TRADE_VENUE=spot
FUTURES_ENABLED=false

# Live orders: MUST be true to place real orders.
TRADING_ENABLED=false

# OpenAI API (optional; strategies still run with heuristics if missing)
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4.1-mini
OPENAI_BASE_URL=                             # Optional: OpenAI-compatible endpoint (local Ollama/vLLM/llama.cpp)
AI_POLICY_MODE=off                          # off | advisory | gated-live
AI_POLICY_MODEL=gpt-4.1-mini
AI_POLICY_MIN_INTERVAL_SECONDS=300
AI_POLICY_MAX_CALLS_PER_DAY=200
AI_POLICY_MAX_CANDIDATES=8
AI_POLICY_MAX_GRID_ALLOC_INCREASE_PCT_PER_DAY=5
AI_POLICY_TUNING_AUTO_APPLY=false
AI_POLICY_SWEEP_AUTO_APPLY=false
AI_POLICY_SWEEP_COOLDOWN_MINUTES=180
AI_POLICY_ALLOW_RISK_RELAXATION=false        # DANGEROUS: allows AI "resume"/risk relax actions when profile permits

# AI autonomy & coach (slow loop)
# Profiles (pick one):
# - safe: suggest-only; may pause grid buys; never relax risk automatically
# - standard: auto-apply tightening; auto-blacklist; no relax
# - pro: can relax within envelope only if AI_POLICY_ALLOW_RISK_RELAXATION=true and governor NORMAL
# - aggressive: pro + can take faster actions (still bounded)
AI_AUTONOMY_PROFILE=safe                     # safe | standard | pro | aggressive
AI_COACH_INTERVAL_SECONDS=600
AI_COACH_MIN_EQUITY_USD=200

# AI tuning envelope (min..max). Recommended presets (copy one):
# safe:      MIN_QUOTE_VOLUME_RANGE=5000000..30000000   MAX_VOLATILITY_RANGE=6..15   RISK_BP_RANGE=10..30   PORTFOLIO_MAX_POS_RANGE=1..2   GRID_MAX_ALLOC_RANGE=10..20
# standard:  MIN_QUOTE_VOLUME_RANGE=3000000..30000000   MAX_VOLATILITY_RANGE=6..18   RISK_BP_RANGE=10..40   PORTFOLIO_MAX_POS_RANGE=1..3   GRID_MAX_ALLOC_RANGE=10..25
# pro:       MIN_QUOTE_VOLUME_RANGE=3000000..30000000   MAX_VOLATILITY_RANGE=6..18   RISK_BP_RANGE=10..60   PORTFOLIO_MAX_POS_RANGE=1..4   GRID_MAX_ALLOC_RANGE=10..35
# aggressive:MIN_QUOTE_VOLUME_RANGE=3000000..30000000   MAX_VOLATILITY_RANGE=6..24   RISK_BP_RANGE=10..80   PORTFOLIO_MAX_POS_RANGE=1..5   GRID_MAX_ALLOC_RANGE=10..40
MIN_QUOTE_VOLUME_RANGE=3000000..30000000
MAX_VOLATILITY_RANGE=6..18
RISK_BP_RANGE=10..60
PORTFOLIO_MAX_POS_RANGE=1..4
GRID_MAX_ALLOC_RANGE=10..35

# Symbol policy: optional whitelist + dynamic TTL bans
SYMBOL_WHITELIST=
AUTO_BLACKLIST_ENABLED=true
AUTO_BLACKLIST_TTL_MIN=360
AUTO_BLACKLIST_TRIGGERS=volumeBelowFloor,spreadTooHigh,volatilitySpike,repeatedSlippage

# Strategy defaults (USDC-first to avoid USDT restrictions in some regions)
SYMBOL=BTCUSDC
QUOTE_ASSET=USDC
HOME_ASSET=USDC

# Universe selection:
# - Leave `ALLOWED_SYMBOLS` empty to auto-discover symbols whose quote is in `ALLOWED_QUOTES`
# - If you want a strict allow-list, set `ALLOWED_SYMBOLS=BTCUSDC,ETHUSDC,...`
ALLOWED_SYMBOLS=
ALLOWED_QUOTES=USDC,EUR
AUTO_SELECT_SYMBOL=true
AUTO_DISCOVER_SYMBOLS=true
UNIVERSE_MAX_SYMBOLS=40

# Liquidity / volatility filters (tighter = fewer but generally safer symbols)
MIN_QUOTE_VOLUME=10000000
MAX_VOLATILITY_PCT=15
BLACKLIST_SYMBOLS=

# News sentiment (optional; must be direct RSS/Atom XML endpoints)
NEWS_FEEDS=https://cointelegraph.com/rss,https://cryptoslate.com/feed/,https://decrypt.co/feed
NEWS_CACHE_MINUTES=20
NEWS_WEIGHT=2

# Persistence
PERSISTENCE_PATH=/app/data/state.json
PERSIST_TO_SQLITE=false
SQLITE_PATH=/app/data/bot.sqlite

# Auto-trading (keep off until you've tested)
AUTO_TRADE_ENABLED=false
AUTO_TRADE_HORIZON=short
AUTO_TRADE_MIN_CONFIDENCE=60
AUTO_TRADE_COOLDOWN_MINUTES=180
DAILY_LOSS_CAP_PCT=2
SLIPPAGE_BPS=10
OCO_ENABLED=true

# Portfolio mode (optional; conservative defaults)
PORTFOLIO_ENABLED=true
PORTFOLIO_MAX_ALLOC_PCT=30
PORTFOLIO_MAX_POSITIONS=2
CONVERSION_ENABLED=false
RISK_OFF_SENTIMENT=-0.3

# Spot grid trading (optional; mean-reversion / range trading)
# Grid is best in sideways markets; it can lose in breakouts/trends.
# Requirements:
# - TRADE_VENUE=spot
# - Grid symbols MUST be quoted in HOME_ASSET (e.g. BTCUSDC if HOME_ASSET=USDC)
GRID_ENABLED=false
GRID_AUTO_DISCOVER=true
GRID_SYMBOLS=                                 # Optional strict list: e.g. BTCUSDC,ETHUSDC
GRID_MAX_ALLOC_PCT=20                         # Smaller is safer; grids lock balances while orders are open
GRID_MAX_ACTIVE_GRIDS=1
GRID_LEVELS=21
GRID_KLINE_INTERVAL=1h
GRID_KLINE_LIMIT=120
GRID_MIN_RANGE_PCT=3
GRID_MAX_RANGE_PCT=12
GRID_MAX_TREND_RATIO=0.35
GRID_GAP_BPS=10
GRID_MIN_STEP_PCT=0.6
GRID_REBALANCE_SECONDS=60
GRID_MAX_NEW_ORDERS_PER_TICK=8
GRID_BOOTSTRAP_BASE_PCT=50
GRID_BREAKOUT_ACTION=cancel                   # cancel | cancel_and_liquidate | none
GRID_BREAKOUT_BUFFER_PCT=0.5
GRID_BUY_PAUSE_ON_LIQUIDITY_HALT=true         # If quote-volume < MIN_QUOTE_VOLUME: cancel open BUYs + pause new BUYs (SELLs stay)
LIQUIDITY_RESUME_TICKS=3                      # Resume BUYs after this many consecutive ticks above MIN_QUOTE_VOLUME
LIQUIDITY_RESUME_MINUTES=5                    # Also require this many minutes since pause before resuming BUYs

# Risk sizing (conservative)
MAX_POSITION_SIZE_USDT=100
RISK_PER_TRADE_BP=25
REFRESH_SECONDS=45

# API/UI auth
API_KEY=change_me
CLIENT_KEY=change_me
BASIC_AUTH_USER=bot
BASIC_AUTH_PASS=botpass

# Frontend
VITE_API_URL=http://localhost:8788
VITE_CLIENT_KEY=change_me
